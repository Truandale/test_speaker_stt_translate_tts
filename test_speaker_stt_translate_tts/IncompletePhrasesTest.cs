using System;
using System.Diagnostics;

namespace test_speaker_stt_translate_tts
{
    /// <summary>
    /// Тест для демонстрации работы фильтра незавершенных фраз
    /// </summary>
    public static class IncompletePhrasesTest
    {
        public static void RunTest()
        {
            Debug.WriteLine("=== ТЕСТ ФИЛЬТРА НЕЗАВЕРШЕННЫХ ФРАЗ ===");
            Debug.WriteLine("");

            // Тестовые фразы из ваших логов
            var testPhrases = new[]
            {
                // Обрезанные фразы - ДОЛЖНЫ БЫТЬ ОТФИЛЬТРОВАНЫ
                "Я забыли ж...",                                      // ❌ Незавершенная фраза
                "I'm gonna write you...",                             // ❌ Только многоточие в конце
                "...choppers from a church...",                      // ❌ Фрагмент с многоточиями
                "...to soothe your...",                              // ❌ Фрагмент с многоточиями
                "what we do",                                        // ❌ Без знаков завершения + с маленькой буквы
                "this is a Apple X for Cogging",                    // ❌ Без знаков завершения + с маленькой буквы
                "и это не человеческая речь",                        // ❌ Без точки + с маленькой буквы
                "в будущем",                                         // ❌ Без точки + с маленькой буквы
                
                // Завершенные фразы - ДОЛЖНЫ БЫТЬ ПРИНЯТЫ
                "What we do?",                                       // ✅ Вопросительный знак + заглавная
                "This is a Apple X for Cogging.",                   // ✅ Точка + заглавная
                "All you are for me, is human what I am to you.",   // ✅ Точка + заглавная
                "MISS WHILE BEST TO WISE!",                         // ✅ Восклицательный знак + заглавная
                "И это не человеческая речь.",                       // ✅ Точка + заглавная (русская)
                "В будущем.",                                        // ✅ Точка + заглавная (русская)
                "У меня есть игрушка, которая играла в старой игре. У меня все еще есть.", // ✅ Завершенное предложение
                
                // Сложные случаи со знаками препинания и заглавными
                "Что делать?!",                                      // ✅ Сочетание знаков + заглавная
                "Не знаю...",                                        // ✅ Многоточие как завершение + заглавная
                "Возможно, но не уверен…",                           // ✅ Многоточие Unicode + заглавная
                "Интересно... но странно.",                          // ✅ Есть точка в конце + заглавная
                "Hmm... maybe?",                                     // ✅ Есть вопросительный знак + заглавная
                
                // Фразы с кавычками, скобками, тире
                "«Сегодня хороший день».",                           // ✅ Кавычки + заглавная + точка
                "(Сегодня хороший день).",                           // ✅ Скобки + заглавная + точка  
                "— Поехали!",                                        // ✅ Тире + заглавная + восклицательный
                "…Но он пришёл.",                                    // ✅ Многоточие в начале + заглавная + точка
                
                // Специальные случаи с цифрами и символами
                "5 минут назад.",                                    // ✅ Цифра в начале + точка
                "@user, привет!",                                   // ✅ Символ @ + восклицательный
                "$100 — это много.",                                // ✅ Символ $ + тире + точка
                
                // Бренды с маленькой буквы (допустимые исключения)
                "iPhone — отличный телефон.",                       // ✅ Бренд + тире + точка
                "eBay — популярная площадка.",                      // ✅ Бренд + тире + точка
                
                // Неправильные случаи - должны быть отфильтрованы
                "привет мир.",                                      // ❌ С маленькой буквы (не бренд)
                "как дела?",                                        // ❌ С маленькой буквы
                "iPhone без точки",                                 // ❌ Без знаков завершения
                "ebay без знаков",                                  // ❌ Без знаков завершения
                
                // Технические токены - должны быть отфильтрованы раньше
                "[BLANK_AUDIO]",                                     // ❌ Технический токен
                "*burp*",                                           // ❌ Эмоциональный маркер
                "[End of Audio]"                                    // ❌ Технический токен
            };

            foreach (var phrase in testPhrases)
            {
                bool isValid = AdvancedSpeechFilter.IsValidSpeechQuick(phrase);
                bool isIncomplete = AdvancedSpeechFilter.IsIncompletePhrase(phrase);
                
                string status = isValid ? "✅ ПРИНЯТ" : "❌ ОТКЛОНЕН";
                string reason = !isValid ? (isIncomplete ? " (незавершенная фраза)" : " (другая причина)") : "";
                
                Debug.WriteLine($"{status}{reason}: '{phrase}'");
            }
            
            Debug.WriteLine("");
            Debug.WriteLine("=== КОНЕЦ ТЕСТА ===");
        }

        /// <summary>
        /// Тест только проверки незавершенных фраз (без других фильтров)
        /// </summary>
        public static void TestIncompletePhrasesOnly()
        {
            Debug.WriteLine("=== ТЕСТ ТОЛЬКО НЕЗАВЕРШЕННЫХ ФРАЗ ===");
            Debug.WriteLine("");

            var testPhrases = new[]
            {
                // Базовые случаи
                "Привет мир",                    // ❌ Без знаков завершения + с заглавной
                "привет мир",                    // ❌ Без знаков завершения + с маленькой (двойная ошибка)
                "Привет мир.",                   // ✅ С точкой + с заглавной
                "Как дела?",                     // ✅ С вопросительным знаком + с заглавной
                "Отлично!",                      // ✅ С восклицательным знаком + с заглавной
                "Не знаю…",                      // ✅ С многоточием + с заглавной
                "Возможно?!",                    // ✅ Сочетание знаков + с заглавной
                
                // Фрагменты и многоточия
                "...начало фразы",               // ❌ Начинается с многоточия (фрагмент)
                "конец фразы...",                // ❌ Только многоточие без других знаков + с маленькой
                "Конец фразы...",                // ❌ Только многоточие без других знаков + с заглавной
                "Середина... и конец.",          // ✅ Есть точка в конце + с заглавной
                "Текст... продолжение?",         // ✅ Есть вопросительный знак + с заглавной
                
                // Специальные символы и кавычки
                "«Привет мир».",                 // ✅ Кавычки + заглавная + точка
                "(Тест системы)!",               // ✅ Скобки + заглавная + восклицательный
                "— Давайте начнем.",             // ✅ Тире + заглавная + точка
                "…И все же он пришел.",          // ✅ Многоточие в начале + заглавная + точка
                
                // Цифры и символы в начале
                "5 лет назад.",                  // ✅ Цифра + точка
                "$500 это много!",               // ✅ Символ доллара + восклицательный
                "@пользователь, привет.",        // ✅ Символ @ + точка
                "#хештег популярен.",            // ✅ Символ # + точка
                
                // Бренды (допустимые исключения)
                "iPhone лучший.",                // ✅ Бренд + точка
                "eBay работает отлично!",        // ✅ Бренд + восклицательный
                "android система хорошая.",      // ✅ Бренд + точка
                
                // Неправильные случаи
                "просто текст",                  // ❌ С маленькой + без знаков
                "еще один тест",                 // ❌ С маленькой + без знаков
                "iPhone без точки",              // ❌ Бренд но без знаков завершения
                "тест с маленькой буквы.",       // ❌ С маленькой (не бренд) + точка
            };

            foreach (var phrase in testPhrases)
            {
                bool isIncomplete = AdvancedSpeechFilter.IsIncompletePhrase(phrase);
                
                string status = isIncomplete ? "❌ НЕЗАВЕРШЕННАЯ" : "✅ ЗАВЕРШЕННАЯ";
                
                Debug.WriteLine($"{status}: '{phrase}'");
            }
            
            Debug.WriteLine("");
            Debug.WriteLine("=== КОНЕЦ ТЕСТА НЕЗАВЕРШЕННЫХ ФРАЗ ===");
        }
    }
}